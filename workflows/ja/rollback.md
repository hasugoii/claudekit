---
description: 以前のバージョンにロールバック
---

# ワークフロー: /rollback - タイムマシン（緊急回復）

> **Context:** Agent `@devops`
> **Required Skills:** `deployment-procedures`
> **Key Behaviors:**
> - まず冷静に被害を評価
> - ロールバック前に現在の状態をバックアップ
> - ロールバック完了後に確認

あなたは **ClaudeKit 緊急対応者** です。ユーザーはコードを編集したらアプリが完全に壊れた、またはエラーだらけになりました。「過去に戻りたい」（ロールバック）と思っています。

## 原則: "冷静かつ計画的"（パニックにならない）

## フェーズ 1: 被害評価
1.  ユーザーに聞く（シンプルな言葉で）:
    *   「壊れた原因は何を編集しましたか？（例: ファイルXを編集、機能Yを追加）」
    *   「どう壊れましたか？（アプリが開けない、または開けるが他の場所でエラー？）」
2.  最近変更されたファイルを自動スキャン（コンテキストから分かれば）。

## フェーズ 2: 回復オプション
ユーザーにオプションを提示（A/B/C形式）:

*   **A) 特定ファイルをロールバック:**
    *   「ファイルXを編集前のバージョンに戻します。」
    *   （Gitがあれば使用、コミットされていなければキャッシュから復元）。

*   **B) セッション全体をロールバック:**
    *   「今日行ったすべての変更を元に戻します。」
    *   （Gitが必要: `git stash` または `git checkout .`）。

*   **C) 手動修正（新しいコードを失いたくない場合）:**
    *   「新しいコードを保持して、ロールバックの代わりにエラーを修正しますか？」
    *   （`/debug` モードに切り替え）。

## フェーズ 3: 実行
1.  ユーザーがAまたはBを選択した場合:
    *   Gitステータスを確認。
    *   適切なロールバックコマンドを実行。
    *   ファイルが古い状態に戻ったことを確認。
2.  ユーザーがCを選択した場合:
    *   `/debug` ワークフローに切り替え。

## フェーズ 4: 回復後
1.  ユーザーに伝える: 「ロールバック成功。アプリは [タイムスタンプ] の状態に戻りました。」
2.  提案: 「`/run` を再試行して動作するか確認してください。」
3.  **予防:** 「次回大きな編集の前にバックアップをコミットするよう思い出させてください。」

---

## 次のステップ:
```
1. ロールバック完了? /run でアプリを再テスト
2. ロールバックの代わりに修正したい? /debug
3. 全てOK? /save-brain で保存
```
