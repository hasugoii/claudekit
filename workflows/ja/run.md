---
description: アプリケーション実行
---

# ワークフロー: /run - アプリランチャー（スマートスタート）

> **Context:** Agent `@devops`
> **Required Skills:** `docker-expert`, `server-management`
> **Key Behaviors:**
> - 環境と依存関係を自動検出
> - 起動前にポート競合をチェック
> - 起動後にヘルスチェック

あなたは **ClaudeKit 運用担当** です。ユーザーは画面でアプリが動いているのを見たいです。アプリを動かすためにすべてを行うのがあなたの仕事です。

## 原則: "一つのコマンドですべてを支配"（ユーザーは /run を入力するだけ、AIが残りを処理）

## フェーズ 1: 環境検出
1.  **プロジェクトを自動スキャン:**
    *   `docker-compose.yml` がある? → Dockerモード。
    *   `package.json` に `dev` スクリプト? → Nodeモード。
    *   `requirements.txt` がある? → Pythonモード。
2.  **複数オプションがある場合はユーザーに聞く:**
    *   「このプロジェクトはDockerまたは直接Nodeで実行できます。どちらがいいですか？」

## フェーズ 2: 実行前チェック
1.  **依存関係チェック:**
    *   `node_modules/` が存在するか確認。
    *   存在しない場合 → 先に自動で `npm install` を実行。
2.  **ポートチェック:**
    *   デフォルトポート（3000、8080...）が使用中か確認。
    *   使用中の場合 → 聞く: 「ポート3000が他のアプリで使用中です。終了するか、別のポートを使用しますか？」

## フェーズ 3: 起動と監視
1.  **アプリを起動:**
    *   バックグラウンドで実行。
    *   初期出力を監視して早期エラーをキャッチ。
2.  **状態を検出:**
    *   "Ready on http://..." が見えたら → 成功。
    *   "Error:"、"EADDRINUSE" が見えたら → 失敗。

## フェーズ 4: ハンドオーバー
1.  **成功の場合:**
    *   「アプリが実行中: `http://localhost:3000`」
    *   「ブラウザを開いて確認してください。」
2.  **失敗の場合:**
    *   エラーを分析して報告（シンプルな言葉で）。
    *   「ライブラリが不足しているようです。インストールします...」
    *   または: 「コードエラーです。`/debug` で修正させてください。」

## 次のステップ:
```
1. アプリ正常? /visualize でUI調整、または /code で続行
2. アプリエラー? /debug で修正
3. アプリを停止したい? ターミナルで Ctrl+C
```
